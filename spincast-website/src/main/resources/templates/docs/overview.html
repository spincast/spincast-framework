{#==========================================
Docs : "overview"
==========================================#}

<section id="overview">
    <h3>
        <a class="anchor" href="#overview" title="permanent link"></a>
        Spincast overview
    </h3>

    {#==========================================
    Section "overview / introduction"
    ==========================================#}
    <div id="introduction">
        <h4>
            <a class="anchor_small" href="#introduction" title="permanent link"></a>
            Introduction
        </h4>
        <p>
            Spincast is based on the shoulders of a giant, <a href="https://github.com/google/guice/wiki/Motivation">Guice</a>
            (from Google).
            Other Java web frameworks may claim they <em>support</em> Guice, and maybe even have a
            section of their documentation dedicated to the topic. Spincast is one of those that is <em>totally</em> built on
            Guice, from the ground up! If you already know Guice, Spincast will be really easy to grasp for you.
        </p>
        <p>
            Guice is not only (in our opinion) the best dependency injection library of the Java ecosystem, but also a
            fantastic base to build modular applications. Everything is divided into <code>modules</code> which
            are swappable and overridable. Each module can declare which dependencies it requires from other
            modules. In fact, Guice is so flexible that you may even find ways of using Spincast we haven't think about!
        </p>
        <p>
            If you know another dependency injection library, like <a href="https://spring.io">Spring</a>, it can also help but 
            you'll probably have to learn one of two new tricks!
        </p> 
        <div class="archZoom">
            <p>
                <img class="inlineIcon" src="/public/images/icons/para.png" /> 
                Here's what using Spincast looks like at a very high level:
            </p>
            <p class="center">
                <img src="/public/images/arch/spincast_high_level.png" />
            </p>
            <p>
                Users make requests to your web application. This application can
                have an <code>HTML</code> interface, built using popular tools like
                <a href="https://jquery.com">jQuery</a>, <a href="https://facebook.github.io/react">React</a>,
                <a href="http://emberjs.com">Ember</a>, <a href="https://angularjs.org">Angular</a>, etc. That
                <code>HTML</code> interface can be generated by Spincast (using a built-in <a href="#templating_engine">templating engine</a>) or
                can be a <code>Single Page Application</code> where Spincast is used as a bootstrapper and a
                data provider (<code>JSON</code> or <code>XML</code>) for the SPA.
            </p>
            <p>
                <img class="inlineIcon" src="/public/images/icons/para.png" /> 
                Spincast is also a good platform to build <code>REST</code> web services or microservices,
                without any user interface, since it "talks" <code>JSON</code> and <code>XML</code> natively.
            </p>
            <p class="center">
                <img src="/public/images/arch/spincast_rest_webservices.png" />
            </p>   
        </div> 
    </div>

    
    {#==========================================
    Section "Overview / Architecture"
    ==========================================#}
    <div id="architecture">
        <h4>
            <a class="anchor_small" href="#architecture" title="permanent link"></a>
            Architecture
        </h4>
        <p>
            Spincast is composed of a <em>core</em> plugin and a set of <em>default</em>
            plugins. The core plugin is responsible for validating that an implementation for all the
            components required in a Spincast application has been bound by other plugins. The
            default plugins provide such default implementations.
        </p>
        <p>
            You use the <a href="#boot_bootstrapper">Bootstrapper</a> to initialize your application. This bootstrapper
            will automatically bind the core plugin and the default plugins, but will also let
            you install extra plugin and custom modules for the components specific to your application :
        </p>
        
        <p class="center tallBottom">
            <img src="/public/images/arch/code_structure.png" />
        </p>
    </div>

    {#==========================================
    Section "architecture / request handling"
    ==========================================#}
    <div id="request_handling">
        <h4>
            <a class="anchor_small" href="#request_handling" title="permanent link"></a>
            Request handling
        </h4>
        <p>
            Here's how a request made by a user is handled by Spincast :
        </p>
        <div class="archZoom">
        
            <p class="center tallBottom">
                <img src="/public/images/arch/request_handling.png" />
            </p>

            <p>
                <img class="inlineIcon" src="/public/images/icons/para.png" />
                First, the embedded HTTP <code>Server</code> receives a request from a user. This server consists 
                of a <a class="javadoc" href="/public/javadoc/org/spincast/core/server/Server.html">Server</a> interface and an
                implementation. The default implementation is provided by 
                the <a href="/plugins/spincast-undertow">spincast-plugins-undertow</a>
                plugin which uses the <a href="http://undertow.io">Undertow</a> HTTP/Websocket server.
            </p>
            <p>
                If the request is for a  <a href="#static_resources">Static Resource</a>, the server serves it directly without even reaching the
                framework. Note that it's also possible to generate the resource, using a standard route, so the request <em>does</em>
                enter the framework. There is even a third option which is what we call 
                <a href="#dynamic_resources">Dynamic Resources</a>:
                if a request is made for a request which currently doesn't exist, the server will pass the request to the framework, the
                framework can then create the resource and return it... The following requests for the same resource will use
                the generated resource and won't reach the framework anymore!
            </p>
            <p>
                <img class="inlineIcon" src="/public/images/icons/para.png" />
                If the request is not for a static resource, the server passes it to the core 
                Spincast component : the <code>Front Controller</code>. The <code>Front Controller</code> is at the very center
                of Spincast! This is one of the very few components that is actually bound by the <code>core</code> plugin
                itself.
            </p>
            <p>
                The job of the <code>Front Controller</code> is to:
                <ul>
                    <li>
                        Ask the <code>Router</code> for the appropriate route to use when a request arrives.
                    </li>
                    <li>
                        Call the <code>Route Handlers</code> of the matching route. A route can have many handlers :
                        they are <a href="#filters">Filters</a> which are run <em>before</em> the <code>Main Handler</code>, the <code>Main Handler</code>
                        itself, and some <a href="#filters">Filters</a> which are run <em>after</em> the <code>Main Handler</code>.
                    </li>
                    <li>
                        If the request is for a <code>WebSocket</code> connection, the handling of the request 
                        is made by a <a href="#websockets_controllers"><code>WebSocket Controller</code></a> instead of a <code>Route Handler</code>.
                        Also, the result is not a simple response but a permanent and full duplex connection where each side 
                        can send messages to the other side.
                        Have a look at the <a href="#websockets">WebSockets</a> section for more information!
                    </li>
                    <li>
                        If no matching route is returned by the <code>Router</code>, the <code>Front Controller</code> 
                        will use a <code>Not Found route</code>. The <code>Not Found route</code> can be a custom
                        one, or the default one provided by Spincast.
                    </li>
                    <li>
                        If any exception occures during any of those steps, the <code>Front Controller</code> 
                        will use an <code>Exception route</code>. The <code>Exception route</code> can be a custom
                        one, or the default one provided by Spincast.
                    </li>
                </ul>
            </p>
            <p>
                <img class="inlineIcon" src="/public/images/icons/para.png" />
                The job of the <a class="javadoc" href="/public/javadoc/org/spincast/core/routing/Router.html"><code>Router</code></a> is to determine the appropriate 
                route to use, given the URL of the request, its <code>HTTP method</code>, etc. It will also
                extract the value of the dynamic path tokens, if any. For example, a route path could be
                <code>"/user/${userId}/tasks"</code>. If a <code>"/user/42/tasks"</code> request is made, the router will
                extract "<em>42</em>" as the value of the <code>userId</code> parameter and make this available to the rest of the
                framework.
            </p>
            <p>
                <img class="inlineIcon" src="/public/images/icons/para.png" />
                Finally:
                <ul>
                    <li>
                        The <code>Route Handlers</code> receive a <code>Request Context</code> (which represents the request),
                        and decide what to return as the response. This can be anything: <code>Json</code>, <code>HTML</code>,
                        <code>XML</code> or even <code>bytes</code>.
                        <br />
                        <span class="underline">or:</span>
                    </li>
                    <li>
                        A <code>WebSocket Controller</code> receives the request for a WebSocket connection, allows or
                        denies it, and then receives and sends messages on that connection.
                    </li>
                </ul>
            </p>
        </div>
    </div>
    
    {#==========================================
    The main components
    ==========================================#}
    <div id="main_components">
        <h4>
            <a class="anchor_small" href="#main_components" title="permanent link"></a>
            The main components
        </h4>
        <p>
            The <em>main components</em> are those without which a Spincast application can't even run. 
            Any class, any <code>plugin</code>, can assume those components are available, so they can 
            inject them and use them!
        </p>
        <p>
            Those main components are all installed by the <a href="#plugins_default">default plugins</a>.
            Have a look at those default plugins for a quick overview of the big blocks constituting Spincast!
        </p>
        <p>
            Spincast is very modular and you can replace any plugin, even the default one. But, when you do this,
            you are responsible for providing any required components this plugin was binding.
        </p>
        
    </div>
    
    {#==========================================
    Section "architecture / Transitive dependencies"
    ==========================================#}
    <div id="dependencies">
        <h4>
            <a class="anchor_small" href="#dependencies" title="permanent link"></a>
            Transitive dependencies
        </h4>
        <p>
            The <code>spincast-core</code> Maven artifact only has two direct dependencies which are external to Spincast:
            
            <ul>
                <li>
                    <strong><a href="https://github.com/google/guice">Guice</a></strong>, which itself pulls some transitive dependencies,
                    such as "<code>Guava</code>" and "<code>jsr305</code>".
                </li>
                <li>
                    <strong><a href="https://www.slf4j.org/">SLF4J</a></strong> : The logging facade.
                </li>
            </ul>
        </p>   
        <p> 
            The versions used for those dependencies are defined in the <code>spincast-parent</code>
            Maven artifact's <code>pom.xml</code>.
        </p> 
        <p> 
            Spincast core also uses some <a href="https://commons.apache.org/">Apache commons</a> libraries,
            but those are <em>shaded</em>, their classes have been relocated under Spincast's 
            <code><em>org.spincast.shaded</em></code> package, so they won't conflit with your own dependencies.
        </p> 
        <p> 
            <img class="inlineIcon" src="/public/images/icons/para.png" />
            That said, each <a href="/plugins">Plugin</a> also adds its own dependencies! If you start with
            the <code>spincast-default</code> Maven artifact, a bunch of transitive dependencies
            will be included. If you need full control over the transitives dependencies added to
            your application, start with the <code>spincast-core</code> Maven artifact and pick, one by one, the
            plugins and implementations you want to use.
        </p> 

    </div>
    
</section>
            
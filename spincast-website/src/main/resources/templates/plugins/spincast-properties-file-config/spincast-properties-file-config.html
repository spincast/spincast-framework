{% extends "../../layout.html" %}

{% block sectionClasses %}plugins hasBreadCrumb plugins-spincast-config-props-file{% endblock %}
{% block meta_title %}Plugins - Spincast Properties File Config{% endblock %}
{% block meta_description %}Allows an application to define its configurations in a .properties file.{% endblock %}

{% block scripts %}
<script>

    {#==========================================
    Initialize the Table Of Content
    ==========================================#}
    $(function() {
        app.toc(230);
    });

</script>
{% endblock %}

{% block body %}

<div class="container pluginDoc">

    <ol class="breadcrumb">
        <li><img class="inlineIcon breadIcon" src="/public/images/icons/bread.png" /> <a href="/plugins">Plugins</a></li>
        <li class="active">Spincast Properties File Config plugin</li>
    </ol>
    
    <div id="sectionTitle" class="row"> 
        <div class="col-xs-12">
            <a href="#top"><h2 class="shortTop noBottom"><img class="inlineIcon" src="/public/images/icons/breadPlugin.png" /> Spincast Properties File Config <span>plugin</span></h2></a>
            <div class="pluginBadges">
                <div class="pluginBadgeTop hint--bottom-left hint--bounce" 
                     data-hint="Plugin's Javadoc">
                     <a class="javadoc" href="/public/javadoc/index.html?org/spincast/plugins/configpropsfile/package-summary.html"><img class="inlineIcon" src="/public/images/javadoc-badge.png" /></a>
                </div>
                <span class="clear"></span>
            </div>   
        </div>
    </div>
    
    <div id="sectionTitleFixed" class="row"> 
        <div class="col-xs-12">
            <a href="#top"><h2 class="shortTop"><img src="/public/images/logo_xsmall.png" /> Spincast Properties File Config <span>plugin</span></h2></a>
        </div>
    </div>

    <div class="row">
        <nav id="toc" class="longTitle col-md-3">
            <ul class="nav nav-stacked">
                <li class="openable"><a href="#top">Overview</a></li>
                <li class="openable"><a href="#installation">Installation</a></li>
                <li class="openable"><a href="#plugin_class">Plugin class</a></li>
                <li class="openable"><a href="#config">Configuration</a></li>
                <li class="openable"><a href="#free_keys">Using free keys</a></li>
                <li class="openable"><a href="#config_keys">Spincast configuration keys</a></li>  
                <li class="openable"><a href="#example_file">Example .properties file</a></li>  
                <li class="openable"><a href="#javadoc">Javadoc</a></li>
            </ul>
        </nav>
        
        <div id="toc-content" class="col-md-9">
        
            <section id="overview">
            
                <h3>
                    <a class="anchor" href="#overview" title="permanent link"></a>
                    Overview
                </h3>
	            <p>
	                Allows an application to define its configurations in an external <code>.properties</code> file.
                    You can then easily have different configurations, depending on the environment the application runs on.
                    You can also use this file to override the <a href="#config_keys">Spincast configurations</a> without the need 
                    to provide a custom <a class="javadoc" href="/public/javadoc/org/spincast/core/config/SpincastConfig.html">SpincastConfig</a> implementation class.
                </p>
                <p> 
                     <img class="inlineIcon" src="/public/images/icons/para.png" />
                    The path to the <code>.properties</code> depends on the <a href="#config">configurations</a> in place. By default :
                    
                    <ul>
                        <li>
                            The plugin tries to find an <code>"app.properties"</code> file in the directory where the application <code>.jar</code> is running.
                        </li>
                        <li>
                            If no <code>"app.properties"</code> file is 
                            found next to the <code>.jar</code>, or if the application is not
                            running from a <code>.jar</code> file (the code may be running inside an IDE, for example), then the 
                            <a href="http://spincast.loc:44420/documentation#default_config">default configurations</a> are used.
                        </li> 
                    </ul>  
	            </p>

                <p>
                    <img class="inlineIcon" src="/public/images/icons/para.png" />
                    If you enable the <code>getSpecificPathMainArgsPosition()</code> option using
                    <a href="#config">configuration</a>, then Spincast will first look at the application's arguments
                    to get the path to the <code>.properties</code> file. For example :
                    
                    <div>
                        <p>
                            <pre class="ace ace-batchfile"
>java -jar mySpincastApp.jar /var/www/mySite/mySite.properties</pre> 
                        </p>
                    </div>  
                </p>
                <p>
                    <img class="inlineIcon" src="/public/images/icons/para.png" />
                    You can also override the 
                    <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFileBased.html#lookForPropsFileSpecificPath--">lookForPropsFileSpecificPath()</a>
                    method if you want to use another way of specifying the path (for example by looking
                    at an <code>environment variable</code>).
                </p>
            </section>

           
            <section id="installation">
                <h3>
                    <a class="anchor" href="#installation" title="permanent link"></a>
                    Installation
                </h3>
                <p>
                    If you use the <code>spincast-default</code> artifact and the standard <a href="/documentation#boot_bootstrapper">Bootstrapper</a>, 
                    register this plugin using :
                    
                    <div>
                        <p>
                            <pre class="ace ace-java" data-ace-hi="3,12,3,56"
>public static void main(String[] args) {

    Spincast.configure()
            .plugin(new SpincastConfigPropsFilePlugin())
            //...
            .init();
}</pre> 
                        </p>
                    </div>
                </p>
                
                <p>
                    If you start from scratch, using the <code>spincast-core</code> artifact, you can use the
                    plugin by :
                </p>
                <p>
                    1. Adding this Maven artifact to your project:
                    <div>
                        <p>
                            <pre class="ace ace-xml"
>&lt;dependency&gt;
    &lt;groupId&gt;org.spincast&lt;/groupId&gt;
    &lt;artifactId&gt;spincast-plugins-config-properties-file&lt;/artifactId&gt;
    &lt;version&gt;{{spincast.spincastCurrrentVersion}}&lt;/version&gt;
&lt;/dependency&gt;</pre> 
                        </p>
                    </div>  
                </p>
                <p>
                    2. Installing the provided <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFilePluginModule.html">SpincastConfigPropsFilePluginModule</a> 
                    module to your Guice context.
                </p>
                <p>
                    <img class="inlineIcon" src="/public/images/icons/para.png" />
                    If you use a custom configuration class (which is recommended), you make this class extend 
                    <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFileBased.html">SpincastConfigPropsFileBased</a> :
                    <div>
                        <p>
                            <pre class="ace ace-java"
>public class AppConfig extends SpincastConfigPropsFileBased implements AppConfig {

    @Inject
    public AppConfig(SpincastUtils spincastUtils,
                     @MainArgs @Nullable String[] mainArgs,
                     @Nullable SpincastConfigPropsFilePluginConfig pluginConfig) {
        super(spincastUtils, mainArgs);
    }

    @Override
    public String getAppName() {
        return getConfig("app.name");
    }

    @Override
    public int getSomeNumericConfig() {
        return getConfigInteger("app.some.other.config", 12345);
    }
}</pre> 
                        </p>
                        <p>
                            <span class="explanation">Explanation :</span>
                            <ul>
                                <li>
                                    <span class="code-line-nbr">1</span> : Our custom configuration class
                                    extends <code>SpincastConfigPropsFileBased</code> but also implements
                                    our custom <code>AppConfig</code> interface.
                                </li>
                                <li>
                                    <span class="code-line-nbr">3-8</span> : Constructor required
                                    to satisfy the base class.
                                </li>
                                <li>
                                    <span class="code-line-nbr">10-13</span> : A first application
                                    specific configuration. We use the <code>getConfig(key)</code>
                                    method to get the value to use from the <code>.properties</code> file. Since
                                    no default value is provided, <em>an exception is throw </em>
                                    if the configuration is not found!
                                </li> 
                                <li>
                                    <span class="code-line-nbr">15-18</span> : A second application
                                    specific configuration. Here we use <code>getConfigInteger(key, defaultValue)</code>
                                    to get an Integer configuration. If the configuration is not found in the
                                    <code>.properties</code> file, the specified default value is used.
                                </li> 
                            </ul>
                        </p>  
                    </div>   
                </p>
            </section>
            
            <section id="plugin_class">
                <h3>
                    <a class="anchor" href="#plugin_class" title="permanent link"></a>
                    Plugin class
                </h3>
                <p>
                    The class implementing the <a class="javadoc" href="/public/javadoc/org/spincast/core/guice/SpincastPlugin.html">SpincastPlugin</a> 
                    interface is <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFilePlugin.html">SpincastConfigPropsFilePlugin</a>.
                </p>
            </section>
            
            
            <section id="config">
                <h3>
                    <a class="anchor" href="#config" title="permanent link"></a>
                    Configuration
                </h3>
                <p>
                    You can bind a <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFilePluginConfig.html">SpincastConfigPropsFilePluginConfig</a>
                    implementation to tweak the default configurations used by this plugin. By default, the
                    <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFilePluginDefault.html">SpincastConfigPropsFilePluginDefault</a>
                    class is used as the implementation.
                </p>  
            </section>

            
            <section id="free_keys">
                <h3 class="noTop">
                    <a class="anchor" href="#free_keys" title="permanent link"></a>
                    Using free keys
                </h3>
                <p>
                    If you want to be able to access your configurations without having to
                    define a method for all of them, you can use the provided <code>FreeKeyConfig</code>
                    interface:
                </p> 
                <p>
                    <div>
                        <p>
                            <pre class="ace ace-java" data-ace-hi="1,58,1,71"
>

public static interface AppConfig extends SpincastConfig, FreeKeyConfig {

    public String someTypedConfig1();
    public Boolean someTypedConfig2();
    
    //...
}</pre> 
                        </p>
                    </div>   
                </p>
                <p>
                    Now, you have access your <code>.properties</code> based configurations without having to
                    define a method for all of them. You can also use the <code>getConfig(...)</code>, 
                    <code>getConfigInteger(...)</code> or <code>getConfigBoolean(...)</code> methods :
                </p> 
                <p>
                    <div>
                        <p>
                            <pre class="ace ace-java"
>AppConfig configs = getAppConfig();

String config = configs.getConfig("some.config.as.string");
config = configs.getConfig("some.non.existing.config", "default value");

Integer configInt = configs.getConfigInteger("some.config.as.int");
configInt = configs.getConfigInteger("some.non.existing.config", 42);

Boolean configBool = configs.getConfigBoolean("some.config.as.bool");
configBool = configs.getConfigBoolean("some.non.existing.config", true);

// Typed configs still work too, of course!
config = configs.someTypedConfig1();
configBool = configs.someTypedConfig2();
</pre> 
                        </p>
                    </div>   
                </p>
                  
            </section>
            
            <section id="config_keys">
                <h3 class="noTop">
                    <a class="anchor" href="#config_keys" title="permanent link"></a>
                    Spincast configuration keys
                </h3>
                <p>
                    In your <code>.properties</code> file, you can override some default Spincast 
                    configuration by using those keys :
                </p> 
                
                <div id="methods">
                    <p>
                        <ul class="apiList">

                            <li>
                                <code class="apiItem">spincast.environment.name</code>
                                <div class="well">
                                    The name of the environment.
                                </div>
                            </li>

                            <li>
                                <code class="apiItem">spincast.environment.isDebug</code>
                                <div class="well">
                                    Should debug mode be enabled? ("<code>true</code>" or "<code>false</code>")
                                </div>
                            </li>
                            
                            <li>
                                <code class="apiItem">spincast.server.host</code>
                                <div class="well">
                                    The host/IP the server should bind to.
                                </div>
                            </li>
                            
                            <li>
                                <code class="apiItem">spincast.httpServer.port</code>
                                <div class="well">
                                    The port of the HTTP server. If not specify or is <code>&lt;= 0</code>
                                    no HTTP server will be started. (Integer value)
                                </div>
                            </li> 

                            <li>
                                <code class="apiItem">spincast.httpsServer.port</code>
                                <div class="well">
                                    The port of the HTTPS (secure) server. If not specify or is <code>&lt;= 0</code>
                                    no HTTPS server will be started. (Integer value)
                                </div>
                            </li> 

                            <li>
                                <code class="apiItem">spincast.httpsServer.keystore.path</code>
                                <div class="well">
                                    The path to the <code>KeyStore</code>, for SSL. Can be a
                                    classpath path or and absolute path.
                                </div>
                            </li> 

                            <li>
                                <code class="apiItem">spincast.httpsServer.keystore.type</code>
                                <div class="well">
                                    The type of the <code>KeyStore</code>, for SSL. For example: "JKS".
                                </div>
                            </li> 

                            <li>
                                <code class="apiItem">spincast.httpsServer.keystore.storepass</code>
                                <div class="well">
                                    The "storepass" of the <code>KeyStore</code>, for SSL.
                                </div>
                            </li> 

                            <li>
                                <code class="apiItem">spincast.httpsServer.keystore.keypass</code>
                                <div class="well">
                                    The "keypass" of the <code>KeyStore</code>, for SSL.
                                </div>
                            </li> 
                        </ul>
                    </p>
                </div>
            </section>
            
            <section id="example_file">
                <h3 class="noTop">
                    <a class="anchor" href="#example_file" title="permanent link"></a>
                    Example <code>.properties</code> file
                </h3>
                <p>
                    <div>
                        <p>
                            <pre class="ace ace-properties"
># Override some default Spincast configurations
spincast.environment.name=prod
spincast.environment.isDebug=false

# App specific configurations
app.name=My supercalifragilisticexpialidocious app!
app.some.other.config=42
</pre> 
                        </p>
                    </div>  
                </p>
            </section>
            
            <section id="javadoc">
                <h3>
                    <a class="anchor" href="#javadoc" title="permanent link"></a>
                    Javadoc
                </h3>
                <p>
                    <ul>
                    
                        <li>
                            <a class="javadoc" href="http://spincast.loc:44420/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFileBased.html">SpincastConfigPropsFileBased</a>
                        </li>
                        <li>
                            <a class="javadoc" href="/public/javadoc/org/spincast/plugins/configpropsfile/SpincastConfigPropsFilePluginConfig.html">SpincastConfigPropsFilePluginConfig</a>
                        </li>

                    </ul>
                </p> 
            </section>
            
        </div>
    </div>
</div> 

{% endblock %}
{#==========================================
Spincast HTTP Client plugin
==========================================#}
{% extends "../../layout.html" %}

{% block sectionClasses %}plugins hasBreadCrumb plugins-spincast-http-client{% endblock %}
{% block meta_title %}Plugins - Spincast HTTP Client{% endblock %}
{% block meta_description %}Client to easily create and send HTTP requests.{% endblock %}

{% block scripts %}
<script>

    {#==========================================
    Initialize the Table Of Content
    ==========================================#}
    $(function() {
        app.toc(230);
    });

</script>
{% endblock %}

{% block body %}

<div class="container pluginDoc">

    <ol class="breadcrumb">
        <li><img class="inlineIcon breadIcon" src="/public/images/icons/bread.png" /> <a href="/plugins">Plugins</a></li>
        <li class="active">Spincast HTTP Client plugin</li>
    </ol>
    
    <div id="sectionTitle" class="row"> 
        <div class="col-xs-12">
            <a href="#top"><h2 class="shortTop noBottom"><img class="inlineIcon" src="/public/images/icons/breadPlugin.png" /> Spincast HTTP Client <span>plugin</span></h2></a>
            <div class="pluginBadges">
                <div class="pluginBadgeTop hint--bottom-left hint--bounce" 
                     data-hint="Plugin's Javadoc">
                     <a class="javadoc" href="/public/javadoc/index.html?org/spincast/plugins/httpclient/package-summary.html"><img class="inlineIcon" src="/public/images/javadoc-badge.png" /></a>
                </div>
                <span class="clear"></span>
            </div>  
        </div>
    </div>
    
    <div id="sectionTitleFixed" class="row"> 
        <div class="col-xs-12">
            <a href="#top"><h2 class="shortTop"><img src="/public/images/logo_xsmall.png" /> Spincast HTTP Client <span>plugin</span></h2></a>
        </div>
    </div>

    <div class="row">
        <nav id="toc" class="longTitle col-md-3">
            <ul class="nav nav-stacked">
                <li class="openable"><a href="#top">Overview</a></li>
                <li class="openable"><a href="#examples">Quick Examples</a></li>
                <li class="openable"><a href="#installation">Installation</a></li>
                <li class="openable"><a href="#usage">Usage</a></li> 
                <li class="openable"><a href="#javadoc">Javadoc</a></li>
            </ul>
        </nav>
        
        <div id="toc-content" class="col-md-9">
        
            <section id="overview">
            
                <h3>
                    <a class="anchor" href="#overview" title="permanent link"></a>
                    Overview
                </h3>
	            <p>
	                Provides an easy way of creating and sending HTTP requests. The interface to inject to
                    get the provided client is
                    <a class="javadoc" href="/public/javadoc/org/spincast/plugins/httpclient/HttpClient.html">HttpClient</a>
                </p>
                <p>
                    Please note that this is the light version of the Spincast HTTP client,
                    without support for <code>WebSockets</code>. If you want your client to be able 
                    to establish WebSocket connections, use the 
                    <a href="/plugins/spincast-http-client-with-websocket">Spincast HTTP Client With WebSocket</a> version!
                </p>
                <p>  
                    This client is built around
                    <a href="https://hc.apache.org/httpcomponents-client-ga/">Apache HttpClient</a>. Note that
                    no extra dependencies are added by this plugin because it uses the
                    <em>shaded</em> version of Apache HttpClient, which is already included in the <code>spincast-core</code>
                    artifact.
                </p>
                <p>  
                    <img class="inlineIcon" src="/public/images/icons/tipy.png" />
                    All the integration tests of Spincast use this HTTP client so
                    have <a class="javadoc" href="https://github.com/spincast/spincast-framework/tree/master/spincast-core-parent/spincast-core-tests/src/test/java/org/spincast/tests">a look at them</a> 
                    for a lot of examples!  
                </p>
            </section>
            
            <section id="examples">
	            <h3>
                    <a class="anchor" href="#examples" title="permanent link"></a>
                    Quick Examples
                </h3>
	            <p>
	                <ul>
                        <li>
                            Simple <code>GET</code> request. We get the response as a string and print it :
                            
                            <div>
                                <p>
                                    <pre class="ace ace-java"
>HttpResponse response = httpClient.GET("https://www.google.com").send();
                                           
System.out.println(response.getContentAsString());</pre>
                                </p>
                            </div> 
                        </li>
                        <li>
                            Complexe <code>POST</code> request. We send a <code>Json</code> object representing
                            a user, with some extra HTTP headers :
                            <div>
                                <p>
                                    <pre class="ace ace-java"
>User user = getUser();
HttpResponse response = httpClient.POST("https://example.com/api/users")
                                   .setEntityJson(user)
                                   .addCookie("cookieKey", "cookieValue")
                                   .addHeaderValue("headerKey", "headerValue")
                                   .send();
                                           
if(response.getStatus() == 200) { // or use : HttpStatus.SC_OK
    String content = response.getContentAsString();
    Cookie cookie = response.getCookie("someCookie");
    String header = response.getHeaderFirst("someHeader"); 
} else {
    //...
}</pre> 
                                </p>
                            </div>
                        </li>
                    </ul>
	            </p>
            </section>
            
	        <section id="installation">
                <h3>
                    <a class="anchor" href="#installation" title="permanent link"></a>
                    Installation
                </h3>              
                <p> 
                    The Spincast Http Client is already available in the <code><em>test</em></code> Maven scope, 
                    when you include the <code>spincast-testing-default</code>
                    or the <code>spincast-testing-core</code> artifacts to help you with your tests. 
                    If you want to use the Spincast Http Client in your application, and not only in your <em>tests</em>, 
                    you have to include it as a regular dependency:
                </p>
                
                <p>
	                <div>
	                    <p>
	                        <pre class="ace ace-xml"
>&lt;dependency&gt;
    &lt;groupId&gt;org.spincast&lt;/groupId&gt;
    &lt;artifactId&gt;spincast-plugins-http-client&lt;/artifactId&gt;
    &lt;version&gt;{{spincast.spincastCurrrentVersion}}&lt;/version&gt;
&lt;/dependency&gt;</pre> 
	                    </p>
	                </div>  
	            </p>
                <p>
                    <img class="inlineIcon" src="/public/images/icons/para.png" />
                    Then, install the plugin's Guice module, by passing it to the <code>Guice.createInjector(...)</code> method:
                    <div>
                        <p>
                            <pre class="ace ace-java" data-ace-hi="2,8,2,110|3,8,3,110"
>Injector guice = Guice.createInjector(
        new AppModule(args),
        new SpincastHttpClientPluginGuiceModule(AppRequestContext.class, 
                                                AppWebsocketContext.class)
        // other modules...
        );</pre> 
                        </p>
                    </div>   
                </p>
                <p>
                    ... or by using the <code>install(...)</code> method from your custom Guice module:
                    <div>
                        <p>
                            <pre class="ace ace-java" data-ace-hi="7,8,7,84|8,8,8,100"
>public class AppModule extends SpincastDefaultGuiceModule {

    //...

    @Override
    protected void configure() {
        super.configure();
        install(new SpincastHttpClientPluginGuiceModule(getRequestContextType(), 
                                                        getWebsocketContextType()));
        // other modules...
    }
    
    // ...
}</pre> 
                        </p>
                    </div>   
                </p>
         
         
            </section>
            
            <section id="usage">
                <h3>
                    <a class="anchor" href="#usage" title="permanent link"></a>
                    Usage
                </h3>
                <p>
                    To use Spincast's HTTP Client, you can inject <code>HttpClient</code> where you need it.
                    This object is a <em>builder</em> : it is thread safe and can be injected in multiple
                    classes. Let's see an example :
                </p>
                <p>
                    <div>
                        <p>
                            <pre class="ace ace-java"
>public class AppController {

    private final HttpClient httpClient;

    @Inject
    public AppController(HttpClient httpClient) {
        this.httpClient = httpClient;
    }

    protected HttpClient httpClient() {
        return this.httpClient;
    }

    public void myRouteHandler(AppRequestContext context) {

        HttpResponse response = httpClient().GET("https://www.google.com").send();
        if(response.getStatus() == HttpStatus.SC_OK) {
            //...
        }
    }
}</pre> 
                        </p>
                    </div>   
                </p>
                <p>
                    <img class="inlineIcon" src="/public/images/icons/para.png" />
                    If you want, you can also <a href="/documentation#extending_request_context">extend your custom Request Context</a> objects to add 
                    <code>HttpClient</code> as an <code>add-on</code>. To do that, let's tweak some components:
                </p>
                <p>
                    Your <code>AppRequestContext</code> interface
                    <div>
                        <p>
                            <pre class="ace ace-java"
>public interface AppRequestContext extends RequestContext&lt;AppRequestContext&gt; {

    //...
    
    public HttpClient httpClient();
}</pre> 
                        </p>
                    </div>   
                </p>
                <p>
                    The Request Context <code>implementation</code> :
                    <div>
                        <p>
                            <pre class="ace ace-java"
>public class AppRequestContext extends RequestContextBase&lt;AppRequestContext&gt;
                               implements AppRequestContext {

    private final HttpClient httpClient;

    @AssistedInject
    public AppRequestContext(@Assisted Object exchange,
                             RequestContextBaseDeps&lt;AppRequestContext&gt; requestContextBaseDeps,
                             HttpClient httpClient) {
        super(exchange, requestContextBaseDeps);
        this.httpClient = httpClient;
    }
    
    //...

    @Override
    public HttpClient httpClient() {
        return this.httpClient;
    }
}</pre> 
                        </p>
                    </div>   
                </p>
                <p>
                    Then, you can use the HTTP Client directly from your <code>Route Handlers</code>! :
                    <div>
                        <p>
                            <pre class="ace ace-java" data-ace-hi="4,39,4,89"
>public class AppController {

    public void myRouteHandler(AppRequestContext context) {

        HttpResponse response = context.httpClient().GET("https://www.google.com").send();
        if(response.getStatus() == HttpStatus.SC_OK) {
            //...
        }
    }
}</pre> 
                        </p>
                    </div>   
                </p>
  
            </section>
            
            
            <section id="javadoc">
                <h3>
                    <a class="anchor" href="#javadoc" title="permanent link"></a>
                    Javadoc
                </h3>
                <p>
                    <ul>
                        <li>
                            <a class="javadoc" href="/public/javadoc/org/spincast/plugins/httpclient/HttpClient.html">HttpClient</a>
                        </li>
                        <li>
                            <a class="javadoc" href="/public/javadoc/org/spincast/plugins/httpclient/HttpRequestBuilder.html">HttpRequestBuilder</a>
                        </li>
                        <li>
                            <a class="javadoc" href="/public/javadoc/org/spincast/plugins/httpclient/HttpResponse.html">HttpResponse</a>
                        </li> 
                    </ul>
                </p> 
            </section>

        </div>
    </div>
</div> 

{% endblock %}
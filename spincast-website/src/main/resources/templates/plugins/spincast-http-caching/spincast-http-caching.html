{#==========================================
Spincast HTTP Caching plugin
==========================================#}
{% extends "../../layout.html" %}

{% block sectionClasses %}plugins plugins-spincast-http-caching{% endblock %}
{% block meta_title %}Plugins - Spincast HTTP Caching{% endblock %}
{% block meta_description %}Spincast HTTP Caching plugin : ETag, Cache-Control, etc.{% endblock %}

{% block scripts %}
<script>

    {#==========================================
    Initialize the Table Of Content
    ==========================================#}
    $(function() {
        app.toc(230);
    });

</script>
{% endblock %}

{% block body %}

<div class="container pluginDoc">

    <ol class="breadcrumb">
        <li><img class="inlineIcon breadIcon" src="/public/images/icons/bread.png" /> <a href="/plugins">Plugins</a></li>
        <li class="active">Spincast HTTP Caching plugin</li>
    </ol>
    
    <div id="sectionTitle" class="row"> 
        <div class="col-xs-12">
            <a href="#top"><h2 class="shortTop noBottom"><img class="inlineIcon" src="/public/images/icons/breadPlugin.png" /> Spincast HTTP Caching <span>plugin</span></h2></a>
            <div class="pluginBadges">
                <div class="pluginBadgeTop hint--bottom-left hint--bounce" 
                     data-hint="Plugin's Javadoc">
                     <a href="/public/javadoc/org/spincast/plugins/httpcaching/package-summary.html"><img class="inlineIcon" src="/public/images/javadoc-badge.png" /></a>
                </div>
                <div class="pluginBadgeTop hint--bottom-left hint--bounce" 
                     data-hint="Core plugin included in the 'spincast-default' artifact"><img class="inlineIcon" src="/public/images/default-badge.png" /></div>
                <span class="clear"></span>
            </div> 
        </div>
    </div>
    
    <div id="sectionTitleFixed" class="row"> 
        <div class="col-xs-12">
            <a href="#top"><h2 class="shortTop"><img src="/public/images/logo_xsmall.png" /> Spincast HTTP Caching  <span>plugin</span></h2></a>
        </div>
    </div>

    <div class="row">
        <nav id="toc" class="longTitle col-md-3">
            <ul class="nav nav-stacked">
                <li class="openable"><a href="#top">Overview</a></li>
                <li class="openable"><a href="#installation">Installation</a></li>
                <li class="openable"><a href="#addon">The request context add-on</a></li>
            </ul>
        </nav>
        
        <div id="toc-content" class="col-md-9">
        
            <section id="overview">
                <h3>
                    <a class="anchor" href="#overview" title="permanent link"></a>
                    Overview
                </h3>
	            <p>
	                The <code>Spincast HTTP Caching</code> plugin provides utilities to
	                send and validate cache headers. The main component is the
	                request context add-on, <a href="#addon"><code>ICacheHeadersRequestContextAddon</code></a>.
	            </p>
	            <p>
	                For the full documentation about HTTP caching using Spincast, please have a look at the
	                <a href="/documentation#http_caching">HTTP caching</a> section.
	            </p>
            </section>
            
	        <section id="installation">
                <h3>
                    <a class="anchor" href="#installation" title="permanent link"></a>
                    Installation
                </h3>
	            <p>
	                If you use the <code>spincast-default</code> artifact, this plugin is already installed so
	                you have nothing more to do!
	            </p>
	            <p>
                    <img class="inlineIcon" src="/public/images/icons/para.png" />
	                If you start from scratch using the <code>spincast-core</code> artifact, you can use the
	                plugin by adding this artifact to your project:
	                <div>
	                    <p>
	                        <pre class="ace ace-xml"
>&lt;dependency&gt;
    &lt;groupId&gt;org.spincast&lt;/groupId&gt;
    &lt;artifactId&gt;spincast-plugins-http-caching&lt;/artifactId&gt;
    &lt;version&gt;{{spincastCurrrentVersion}}&lt;/version&gt;
&lt;/dependency&gt;</pre> 
	                    </p>
	                </div>  
	            </p>
	            <p>
	                <img class="inlineIcon" src="/public/images/icons/para.png" />
	                You then install the plugin's Guice module, by passing it to the <code>Guice.createInjector(...)</code> method:
	                <div>
	                    <p>
	                        <pre class="ace ace-java" data-ace-hi="2,8,2,110|3,8,3,110"
>Injector guice = Guice.createInjector(
        new SpincastCoreGuiceModule(args),
        new SpincastHttpCachingPluginGuiceModule(IAppRequestContext.class, 
                                                 IAppWebsocketContext.class)
        // other modules...
        );</pre> 
	                    </p>
	                </div>   
	            </p>
	            <p>
	                ... or by using the <code>install(...)</code> method from your custom Guice module:
	                <div>
	                    <p>
	                        <pre class="ace ace-java" data-ace-hi="5,8,5,80|6,8,6,100"
>public class AppModule extends SpincastCoreGuiceModule {

    @Override
    protected void configure() {
        super.configure();
        install(new SpincastHttpCachingPluginGuiceModule(getRequestContextType(), 
                                                         getWebsocketContextType()));
        // other modules...
    }
    
    // ...
}</pre> 
	                    </p>
	                </div>   
	            </p>
            </section>
            
            <section id="addon">
                <h3>
                    <a class="anchor" href="#addon" title="permanent link"></a>
                    The request context add-on 
                </h3>
                <div id="request_context_example">
                    <p>
                        <div>
                            <p>
                                <h4><img class="inlineIcon" src="/public/images/icons/para.png" /> Quick example :</h4>
                                <pre class="ace ace-java" data-ace-hi="1,30,1,40"
>public void myHandler(IAppRequestContext context) {
    
    // Sends "Cache-Control" header
    context.cacheHeaders().cache(60);
    
    // Validates the "freshness" headers
    if(context.cacheHeaders().eTag(etag).lastModified(date).validate(true)) {
        return;
    } 
}</pre> 
                            </p>
                        </div>
                    </p>
                </div>
                
             <div id="request_context_methods">
                    <p>
                        <h4><img class="inlineIcon" src="/public/images/icons/para.png" /> Methods :</h4>
                        <ul class="apiList">
          
<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>eTag</span>(String currentTag)</code>
    <div class="well">
         Specifies the current ETag (strong) of the resource.
 <p>
 A strong comparison will be used to compare the request ETag to this
 current ETag.
 </p>
 <p>
 Skip, or use <code>null</code> if the resource doesn't exist.
 </p>

    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>eTag</span>(String currentTag, boolean currentTagIsWeak)</code>
    <div class="well">
         Specifies the current strong or weak ETag of the resource.
 <p>
 A strong comparison will be used to compare the request ETag to this
 current ETag.
 </p>
 <p>
 Skip, or use <code>null</code> if the resource doesn't exist.
 </p>

    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>eTag</span>(String currentTag, boolean currentTagIsWeak, boolean weakComparison)</code>
    <div class="well">
         Specifies the current strong or weak ETag of the resource.
 <p>
 Skip, or use <code>null</code> if the resource doesn't exist.
 </p>

        <div class="apiItemFooter">
            @param weakComparison should a weak comparison be used instead of
 a strong one to compare the request ETag to the current ETag?

        </div>
    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>lastModified</span>(Date lastModificationDate)</code>
    <div class="well">
         Specifies the last modification date of the resource.
 <p>
 Skip, or use <code>null</code> if the resource doesn't exist.
 </p>

    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>cache</span>(int seconds)</code>
    <div class="well">
         The number of seconds the client should cache this resource
 before requesting it again.

    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>cache</span>(int seconds, boolean isPrivate)</code>
    <div class="well">
         The number of seconds the client should cache this resource
 before requesting it again.

        <div class="apiItemFooter">
            @param isPrivate should the cache be 'private'?
 (<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching?hl=en#public-vs-private">help</a>)

        </div>
    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>cache</span>(int seconds, boolean isPrivate, Integer secondsCdn)</code>
    <div class="well">
         The number of seconds the client should cache this resource
 before requesting it again.

        <div class="apiItemFooter">
            @param isPrivate should the cache be 'private'?
 (<a href="https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/http-caching?hl=en#public-vs-private">help</a>)
<br />@param secondsCdn The number of seconds the resource associated with
 this route should be cached by a CDN/proxy. If <code>null</code>, it
 won't be used.

        </div>
    </div>
</li>

<li>
    <code class="apiItem">ICacheHeadersRequestContextAddon&lt;R&gt; <span>noCache</span>()</code>
    <div class="well">
         Sends "No Cache" headers so the resource is not cached
 at all by the client.

    </div>
</li>

<li>
    <code class="apiItem">boolean <span>validate</span>(boolean resourceCurrentlyExists)</code>
    <div class="well">
         Call this when you are done setting
 <code>ETag</code> and/or <code>Last-Modified</code> to validate
 them agains the headers sent by the client.
 <p>
 If this method returns <code>true</code>, the route handler should return immediately
 without returning/creating/modifying/deleting the associated resource! Appropriate headers 
 have already been set on the response.
 </p>

        <div class="apiItemFooter">
            @param resourceCurrentlyExists Does the resource currently exist?

        </div>
    </div>
</li>




			            </ul>
			        </p>
			    </div> 
			</section>
			
			
        </div>
    </div>
    
</div> 

{% endblock %}